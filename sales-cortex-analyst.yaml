name: sales_semantic_model
description: The Model is going to analyse the three tables, Orders, Customers and Nations countries.
tables:
  - name: ORDERS
    description: This table contains all the orders.
    base_table:
      database: POWER_AUTOMATE
      schema: PUBLIC
      table: ORDERS
    primary_key:
      columns:
        - O_ORDERKEY
        - O_CUSTKEY
    time_dimensions:
      - name: O_ORDERDATE
        synonyms:
          - Order Date
          - Create Date
          - Orders Placed
        description: ''
        expr: O_ORDERDATE
        data_type: DATE
    facts:
      - name: total_order_value
        synonyms:
          - total revenue
          - net sales
        description: Order value
        expr: SUM(ORDERS.O_TOTALPRICE)
        data_type: NUMBER
    metrics:
      - name: total_revenue
        synonyms:
          - total revenue
          - net sales
        expr: SUM(ORDERS.O_TOTALPRICE)
    synonyms: []
    dimensions:
      - expr: O_CUSTKEY
        name: O_CUSTKEY
        data_type: NUMBER(38, 0)
        description: O_CUSTKEY
        synonyms:
          - O_CUSTKEY
      - expr: o_orderkey
        name: o_orderkey
        data_type: NUMBER(38, 0)
        description: o_orderkey
        synonyms:
          - o_orderkey
  - name: CUSTOMER
    description: This table contains all the Customers.
    base_table:
      database: POWER_AUTOMATE
      schema: PUBLIC
      table: CUSTOMER
    primary_key:
      columns:
        - C_CUSTKEY
        - C_NATIONKEY
    facts:
      - name: Customer_Balance
        synonyms:
          - balance of the customer
          - total balance
        description: Balance
        expr: SUM(CUSTOMER.C_ACCTBAL)
        data_type: NUMBER
    metrics:
      - name: Customer_Balance
        synonyms:
          - balance of the customer
          - total balance
        expr: SUM(CUSTOMER.C_ACCTBAL)
    filters:
      - name: Automobile_Customers
        synonyms:
          - Automobile
          - Automobile Customers
        description: The marketing segment of different Customers
        expr: CUSTOMER.C_MKTSEGMENT IN ('AUTOMOBILE')
    dimensions:
      - expr: C_CUSTKEY
        name: C_CUSTKEY
        data_type: NUMBER(38, 0)
        synonyms:
          - C_CUSTKEY
      - expr: C_NATIONKEY
        name: C_NATIONKEY
        data_type: NUMBER(38, 0)
        description: C_NATIONKEY
        synonyms:
          - C_NATIONKEY
      - expr: C_NAME
        name: C_NAME
        data_type: VARCHAR(16777216)
        description: C_NAME
        synonyms:
          - C_NAME
        sample_values:
          - Customer#000000001
          - Customer#000000002
          - Customer#000000003
  - name: NATION
    description: This table contains different Countries of the customers.
    base_table:
      database: POWER_AUTOMATE
      schema: PUBLIC
      table: NATION
    primary_key:
      columns:
        - N_NATIONKEY
    filters:
      - name: north_america
        synonyms:
          - NA
          - North America region
        description: |
          Filter to restrict data to orders from North America.
        expr: nation.N_NAME IN ('Canada', 'Mexico', 'United States')
    dimensions:
      - expr: N_NATIONKEY
        name: N_NATIONKEY
        data_type: NUMBER(38, 0)
        description: N_NATIONKEY
        synonyms:
          - N_NATIONKEY
      - expr: UPPER(N_NAME)
        name: n_name
        data_type: VARCHAR(16777216)
        description: n_name
        synonyms:
          - Nation Name
          - Country
        sample_values:
          - ALGERIA
          - ARGENTINA
          - BRAZIL
          - KENYA
relationships:
  - name: customer_to_orders
    left_table: ORDERS
    right_table: CUSTOMER
    relationship_columns:
      - left_column: O_CUSTKEY
        right_column: C_CUSTKEY
    join_type: left_outer
    relationship_type: many_to_one
  - name: nation_to_customer
    left_table: CUSTOMER
    right_table: NATION
    relationship_columns:
      - left_column: C_NATIONKEY
        right_column: N_NATIONKEY
    join_type: left_outer
    relationship_type: many_to_one
verified_queries:
  - name: Top 3 Customers based on order value
    question: List the top 3 customers based on their Order value ?
    use_as_onboarding_question: true
    sql: SELECT c_custkey, SUM(__orders.o_totalprice) AS total_order_value FROM customer LEFT JOIN orders ON __customer.c_custkey = __orders.o_custkey GROUP BY c_custkey HAVING NOT total_order_value IS NULL ORDER BY total_order_value DESC NULLS LAST LIMIT 3 /* Generated by Cortex Analyst */
    verified_by: Azar Mohammed Jafurullakhan
    verified_at: 1740509087
  - name: Nation Top 3
    question: List the Top 3 Nations based on order value ?
    use_as_onboarding_question: false
    sql: SELECT n_name /* n_nationkey, */, SUM(o_totalprice) AS total_order_value FROM nation LEFT JOIN customer ON n_nationkey = c_nationkey LEFT JOIN orders ON c_custkey = o_custkey GROUP BY n_name HAVING NOT total_order_value IS NULL ORDER BY total_order_value DESC NULLS LAST LIMIT 3
    verified_by: Azar Mohammed Jafurullakhan
    verified_at: 1740510032
  - name: Order placed on 1993
    question: How many orders are placed on the year 1993 ?
    use_as_onboarding_question: false
    sql: SELECT COUNT(DISTINCT o.o_orderkey) AS total_orders FROM orders AS o WHERE YEAR(o.o_orderdate) = 1993 /* Generated by Cortex Analyst */
    verified_by: Azar Mohammed Jafurullakhan
    verified_at: 1740510686
  - name: Customer Centric
    question: which Customer has the most Orders in Canada ?
    use_as_onboarding_question: false
    sql: SELECT c_name, COUNT(DISTINCT o_orderkey) AS total_orders FROM customer LEFT JOIN orders ON __customer.c_custkey = __orders.o_custkey LEFT JOIN nation ON __customer.c_nationkey = __nation.n_nationkey WHERE n_name = 'CANADA' GROUP BY c_name HAVING NOT total_orders IS NULL ORDER BY total_orders DESC NULLS LAST LIMIT 1 /* Generated by Cortex Analyst */ /* Generated by Cortex Analyst */
    verified_by: Azar Mohammed Jafurullakhan
    verified_at: 1740539132